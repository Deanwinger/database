# 高性能MySQL的学习笔记

## 第六章 查询优化
- 查询优化、索引优化、库表结构优化需要齐头并进；

### 6.1 为什么查询会慢
- 查询的生命周期大致可以按照顺序来看：
~~~
    从客户端，到服务器，然后在服务器上进行解析，生成执行计划，执行（最重要环节），并返回结果给客户端；
~~~

### 6.2 慢查询基础： 优化数据访问
- 大部分性能低下的查询都可以通过减少访问的数据量的方式进行优化, 步骤：
~~~
    1. 确认应用程序是否再检索大量超过需要的数据;
    2. 确认Mysql服务层是否在分析大量超过需要的数据行;
~~~

#### 6.2.1 是否向数据库请求了不需要的数据
- 典型案例
~~~
    P197的例子值得一看
    1. 查询不需要的记录
    最简单有效的方法就是再这样的查询后面加上LIMIT;

    2. 多表关联时返回全部列
    只取需要的列

    3.总是取出全部列

    4.重复查询相同的数据
~~~

#### 6.2.3 mysql是否在扫描额外的记录
- 最简单的查询开销的三个指标如下：
~~~
    1.响应时间
        a. 响应时间是两部分之和：服务时间和排队时间;
        b. 可使用“快速上限估计”法来估算查询的响应时间;
    2.扫描的行数
        a. mysql有好几种访问方式查找并返回一行结果;
        b. 在explain语句中的type列反映了访问类型,从全表扫描，索引扫描， 范围扫描，唯一索引查询，常数引用等;
        c. 如果查询没有办法找到合适的访问类型，通常可以可以增加一个合适的索引;

    3.返回的行数
~~~

### 6.3 重构查询的方式


### 6.1 为什么查询会慢
#### 6.1.1 索引的类型